<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>l23linearmodels – Geometric Algorithms</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-29e2c20b02301cfff04dc8050bf30c7e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-fec4eca8e712537310c7ebcc1543822c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./L23LinearModels.html">Linear Models</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/DiagramAR-icon.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./landing_page.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L01LinearEquations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Equations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L02Numerics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">(Getting Serious About) Numbers</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L03RowReductions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gaussian Elimination</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L04VectorEquations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Vector Equations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L05Axb.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="math inline">\(A\mathbf{x} = \mathbf{b}\)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L06LinearIndependence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Independence</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L07LinearTransformations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Transformations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L08MatrixofLinearTransformations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Matrix of a Linear Transformation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L09MatrixOperations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Matrix Algebra</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L10MatrixInverse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Inverse of a Matrix</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L11MarkovChains.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Markov Chains</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L12MatrixFactorizations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Matrix Factorizations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L13ComputerGraphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Computer Graphics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L14Subspaces.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Subspaces</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L15DimensionRank.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dimension and Rank</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L16Eigenvectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Eigenvectors and Eigenvalues</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L17CharacteristicEqn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Characteristic Equation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L18Diagonalization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Diagonalization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L19PageRank.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">PageRank</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L20Orthogonality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analytic Geometry in <span class="math inline">\(\mathbb{R}^n\)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L21OrthogonalSets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Orthogonal Sets and Projection</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L22LeastSquares.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Least Squares</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L23LinearModels.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Linear Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L24SymmetricMatrices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Symmetric Matrices</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L25SVD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Singular Value Decomposition</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./L26ApplicationsOfSVD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Applications of the SVD</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#linear-models" id="toc-linear-models" class="nav-link active" data-scroll-target="#linear-models">Linear Models</a></li>
  <li><a href="#regression-problems" id="toc-regression-problems" class="nav-link" data-scroll-target="#regression-problems">Regression Problems</a></li>
  <li><a href="#the-framework-of-linear-models" id="toc-the-framework-of-linear-models" class="nav-link" data-scroll-target="#the-framework-of-linear-models">The Framework of Linear Models</a></li>
  <li><a href="#fitting-a-line-to-data" id="toc-fitting-a-line-to-data" class="nav-link" data-scroll-target="#fitting-a-line-to-data">Fitting a Line to Data</a></li>
  <li><a href="#a-least-squares-problem" id="toc-a-least-squares-problem" class="nav-link" data-scroll-target="#a-least-squares-problem">A Least-Squares Problem</a></li>
  <li><a href="#the-general-linear-model" id="toc-the-general-linear-model" class="nav-link" data-scroll-target="#the-general-linear-model">The General Linear Model</a></li>
  <li><a href="#least-squares-fitting-of-other-models" id="toc-least-squares-fitting-of-other-models" class="nav-link" data-scroll-target="#least-squares-fitting-of-other-models">Least-Squares Fitting of Other Models</a></li>
  <li><a href="#multiple-regression" id="toc-multiple-regression" class="nav-link" data-scroll-target="#multiple-regression">Multiple Regression</a></li>
  <li><a href="#multiple-regression-in-practice" id="toc-multiple-regression-in-practice" class="nav-link" data-scroll-target="#multiple-regression-in-practice">Multiple Regression in Practice</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<!--
This comment somehow suppresses the title page
-->
<section id="linear-models" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="linear-models">Linear Models</h2>

<div class="no-row-height column-margin column-container"><div class="">
<p><a href="https://commons.wikimedia.org/wiki/File:Sir_Francis_Galton_by_Charles_Wellington_Furse.jpg#/media/File:Sir_Francis_Galton_by_Charles_Wellington_Furse.jpg">Sir Francis Galton by Charles Wellington Furse</a> by Charles Wellington Furse (died 1904) - <a href="//en.wikipedia.org/wiki/National_Portrait_Gallery,_London" class="extiw" title="en:National Portrait Gallery, London">National Portrait Gallery</a>: <a rel="nofollow" class="external text" href="http://www.npg.org.uk/collections/search/portrait.php?search=ap&amp;npgno=3916&amp;eDate=&amp;lDate=">NPG 3916</a></p>
</div><div class="">
<p>Many parts of this page are based on <em>Linear Algebra and its Applications,</em> by David C. Lay</p>
</div></div>
<div class="columns">
<div class="column" style="width:50%;">
<p><img src="images/Sir_Francis_Galton_by_Charles_Wellington_Furse.jpg" class="img-fluid" alt="Sir Francis Galton"></p>
</div><div class="column" style="width:50%;">
<p><img src="images/galton-title.png" class="img-fluid" style="width:80.0%"> <img src="images/galton-regression.png" class="img-fluid" style="width:80.0%"></p>
</div>
</div>
<div class="fragment">
<p>In 1886 Francis Galton published his observations about how random factors affect outliers.</p>
<p>This notion has come to be called “regression to the mean” because unusually large or small phenomena, after the influence of random events, become closer to their mean values (less extreme).</p>
</div>
<p>One of the most fundamental kinds of machine learning is the construction of a model that can be used to summarize a set of data.</p>
<p>A model is a concise description of a dataset or a real-world phenomenon.</p>
<p>For example, an equation can be a model if we use the equation to describe something in the real world.</p>
<div class="fragment">
<p>The most common form of modeling is <strong>regression</strong>, which means constructing an equation that describes the relationships among variables.</p>
</div>
</section>
<section id="regression-problems" class="level2">
<h2 class="anchored" data-anchor-id="regression-problems">Regression Problems</h2>
<div class="fragment">
<p>For example, we may look at these points and observe that they approximately lie on a line.</p>
<p>So we could decide to <strong>model</strong> this data using a line.</p>
<div class="ctrd">
<div id="de45cc3b" class="cell" data-execution_count="2">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="L23LinearModels_files/figure-html/cell-3-output-1.png" width="501" height="476" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p>We may look at these points and decide to model them using a quadratic function.</p>
<div class="ctrd">
<div id="f53c8a71" class="cell" data-execution_count="3">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="L23LinearModels_files/figure-html/cell-4-output-1.png" width="501" height="476" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<p>And we may look at these points and decide to model them using a logarithmic function.</p>
<div class="ctrd">
<div id="2313b7bd" class="cell" data-execution_count="4">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="L23LinearModels_files/figure-html/cell-5-output-1.png" width="501" height="476" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<p>Clearly, none of these datasets agrees perfectly with the proposed model. So the question arises:</p>
<p>How do we find the <strong>best</strong> linear function (or quadratic function, or logarithmic function) given the data?</p>
</section>
<section id="the-framework-of-linear-models" class="level2">
<h2 class="anchored" data-anchor-id="the-framework-of-linear-models">The Framework of Linear Models</h2>
<div class="fragment">
<p>The regression problem has been studied extensively in the field of statistics and machine learning.</p>
<p>Certain terminology is used:</p>
<ul>
<li>Some values are referred to as “independent,” and</li>
<li>Some values are referred to as “dependent.”</li>
</ul>
</div>
<div class="fragment">
<p>The basic regression task is:</p>
<ul>
<li>given a set of independent variables</li>
<li>and the associated dependent variables,</li>
<li>estimate the parameters of a model (such as a line, parabola, etc) that describes how the dependent variables are related to the independent variables.</li>
</ul>
</div>
<div class="fragment">
<p>The independent variables are collected into a matrix <span class="math inline">\(X,\)</span> which is called the <strong>design matrix.</strong></p>
<p>The dependent variables are collected into an <strong>observation</strong> vector <span class="math inline">\(\mathbf{y}.\)</span></p>
<p>The parameters of the model (for any kind of model) are collected into a <strong>parameter</strong> vector <span class="math inline">\(\beta.\)</span></p>
</div>
</section>
<section id="fitting-a-line-to-data" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="fitting-a-line-to-data">Fitting a Line to Data</h2>
<div class="fragment">
<p>The first kind of model we’ll study is a linear equation:</p>
<p><span class="math display">\[y = \beta_0 + \beta_1 x.\]</span></p>
<p>This is the most commonly used type of model, particularly in fields like economics, psychology, biology, etc.</p>
<p>The reason it is so commonly used is that, like Galton’s data, experimental data often produce points <span class="math inline">\((x_1, y_1), \dots, (x_n,y_n)\)</span> that seem to lie close to a line.</p>
</div>
<div class="fragment">
<p>The question we must confront is: given a set of data, how should we “fit” the equation of the line to the data?</p>
<p>Our intuition is this: we want to determine the parameters <span class="math inline">\(\beta_0, \beta_1\)</span> that define a line that is as “close” to the points as possible.</p>
</div>
<p>Let’s develop some terminology for evaluating a model.</p>
<p>Suppose we have a line <span class="math inline">\(y = \beta_0 + \beta_1 x\)</span>. For each data point <span class="math inline">\((x_j, y_j),\)</span> there is a point <span class="math inline">\((x_j, \beta_0 + \beta_1 x_j)\)</span> that is the point on the line with the same <span class="math inline">\(x\)</span>-coordinate.</p>

<div class="no-row-height column-margin column-container"><div class="">
<p>Image credit: <em>Linear Algebra and its Applications,</em> by David C. Lay, 4th ed.</p>
</div></div><div class="fragment">
<div class="ctrd">
<p><img src="images/Lay-fig-6-6-1.jpg" class="img-fluid" style="width:75.0%"></p>
</div>
</div>
<div class="fragment">
<p>We call <span class="math inline">\(y_j\)</span> the <strong>observed</strong> value of <span class="math inline">\(y\)</span></p>
<p>and we call <span class="math inline">\(\beta_0 + \beta_1 x_j\)</span> the <strong>predicted</strong> <span class="math inline">\(y\)</span>-value.</p>
<p>The difference between an observed <span class="math inline">\(y\)</span>-value and a predicted <span class="math inline">\(y\)</span>-value is called a <strong>residual</strong>.</p>
</div>
<div class="fragment">
<p>There are several ways to measure how “close” the line is to the data.</p>
<p>The usual choice is to sum the squares of the residuals.</p>
<p>(Note that the residuals themselves may be positive or negative – by squaring them, we ensure that our error measures don’t cancel out.)</p>
</div>
<div class="fragment">
<p>The <strong>least-squares line</strong> is the line <span class="math inline">\(y = \beta_0 + \beta_1x\)</span> that minimizes the sum of squares of the residuals.</p>
<p>The coefficients <span class="math inline">\(\beta_0, \beta_1\)</span> of the line are called <strong>regression coefficients.</strong></p>
</div>
</section>
<section id="a-least-squares-problem" class="level2">
<h2 class="anchored" data-anchor-id="a-least-squares-problem">A Least-Squares Problem</h2>
<div class="fragment">
<p>Let’s imagine for a moment that the data fit a line perfectly.</p>
<p>Then, if each of the data points happened to fall exactly on the line, the parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> would satisfy the equations</p>
<p><span class="math display">\[\beta_0 + \beta_1 x_1 = y_1 \]</span> <span class="math display">\[\beta_0 + \beta_1 x_2 = y_2 \]</span> <span class="math display">\[\beta_0 + \beta_1 x_3 = y_3 \]</span> <span class="math display">\[ \vdots\]</span> <span class="math display">\[\beta_0 + \beta_1 x_n = y_n \]</span></p>
</div>
<div class="fragment">
<p>We can write this system as</p>
<p><span class="math display">\[X\mathbf{\beta} = \mathbf{y}\]</span></p>
<p>where</p>
<p><span class="math display">\[X=\begin{bmatrix}1&amp;x_1\\1&amp;x_2\\\vdots&amp;\vdots\\1&amp;x_n\end{bmatrix},\;\;\mathbf{\beta} = \begin{bmatrix}\beta_0\\\beta_1\end{bmatrix},\;\;\mathbf{y}=\begin{bmatrix}y_1\\y_2\\\vdots\\y_n\end{bmatrix}\]</span></p>
</div>
<div class="fragment">
<p>Of course, if the data points don’t actually lie exactly on a line,</p>
<p>… then there are no parameters <span class="math inline">\(\beta_0, \beta_1\)</span> for which the predicted <span class="math inline">\(y\)</span>-values in <span class="math inline">\(X\mathbf{\beta}\)</span> equal the observed <span class="math inline">\(y\)</span>-values in <span class="math inline">\(\mathbf{y}\)</span>,</p>
<p>… and <span class="math inline">\(X\mathbf{\beta}=\mathbf{y}\)</span> has no solution.</p>
</div>
<p>Now, since the data doesn’t fall exactly on a line, we have decided to seek the <span class="math inline">\(\beta\)</span> that minimizes the sum of squared residuals, ie,</p>
<p><span class="math display">\[\sum_i (\beta_0 + \beta_1 x_i - y_i)^2\]</span></p>
<div class="fragment">
<p><span class="math display">\[=\Vert X\beta -\mathbf{y}\Vert^2\]</span></p>
</div>
<div class="fragment">
<p>This is key: <strong>the sum of squares of the residuals</strong> is <strong>exactly</strong> the <strong>square of the distance between the vectors <span class="math inline">\(X\mathbf{\beta}\)</span> and <span class="math inline">\(\mathbf{y}.\)</span></strong></p>
</div>
<div class="fragment">
<p>This is a least-squares problem, <span class="math inline">\(A\mathbf{x} = \mathbf{b},\)</span> with different notation.</p>
</div>
<div class="fragment">
<p><em>Computing the least-squares solution of <span class="math inline">\(X\mathbf{\beta} = \mathbf{y}\)</span> is equivalent to finding the <span class="math inline">\(\mathbf{\beta}\)</span> that determines the least-squares line.</em></p>
<div class="ctrd">
<div id="6b80f318" class="cell" data-execution_count="5">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="L23LinearModels_files/figure-html/cell-6-output-1.png" width="501" height="476" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p><strong>Example 1.</strong> Find the equation <span class="math inline">\(y = \beta_0 + \beta_1 x\)</span> of the least-squares line that best fits the data points</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>x</th>
<th>y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2</td>
<td>1</td>
</tr>
<tr class="even">
<td>5</td>
<td>2</td>
</tr>
<tr class="odd">
<td>7</td>
<td>3</td>
</tr>
<tr class="even">
<td>8</td>
<td>3</td>
</tr>
</tbody>
</table>
<div class="fragment">
<div class="ctrd">
<div id="63313cc1" class="cell" data-execution_count="6">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="L23LinearModels_files/figure-html/cell-7-output-1.png" width="462" height="447" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<p><strong>Solution.</strong> Use the <span class="math inline">\(x\)</span>-coordinates of the data to build the design matrix <span class="math inline">\(X\)</span>, and the <span class="math inline">\(y\)</span>-coordinates to build the observation vector <span class="math inline">\(\mathbf{y}\)</span>:</p>
<p><span class="math display">\[X = \begin{bmatrix}1&amp;2\\1&amp;5\\1&amp;7\\1&amp;8\end{bmatrix},\;\;\;\mathbf{y}=\begin{bmatrix}1\\2\\3\\3\end{bmatrix}\]</span></p>
</div>
<div class="fragment">
<p>Now, to obtain the least-squares line, find the least-squares solution to <span class="math inline">\(X\mathbf{\beta} = \mathbf{y}.\)</span></p>
</div>
<div class="fragment">
<p>We do this via the method we learned last lecture (just with new notation):</p>
<p><span class="math display">\[X^TX\mathbf{\beta} = X^T\mathbf{y}\]</span></p>
</div>
<div class="fragment">
<p>So, we compute:</p>
<p><span class="math display">\[X^TX = \begin{bmatrix}1&amp;1&amp;1&amp;1\\2&amp;5&amp;7&amp;8\end{bmatrix}\begin{bmatrix}1&amp;2\\1&amp;5\\1&amp;7\\1&amp;8\end{bmatrix} = \begin{bmatrix}4&amp;22\\22&amp;142\end{bmatrix}\]</span></p>
<p><span class="math display">\[X^T\mathbf{y} =  \begin{bmatrix}1&amp;1&amp;1&amp;1\\2&amp;5&amp;7&amp;8\end{bmatrix}\begin{bmatrix}1\\2\\3\\3\end{bmatrix} = \begin{bmatrix}9\\57\end{bmatrix}\]</span></p>
</div>
<div class="fragment">
<p>So the normal equations are:</p>
<p><span class="math display">\[\begin{bmatrix}4&amp;22\\22&amp;142\end{bmatrix}\begin{bmatrix}\beta_0\\\beta_1\end{bmatrix} = \begin{bmatrix}9\\57\end{bmatrix}\]</span></p>
</div>
<div class="fragment">
<p>Solving, we get:</p>
<p><span class="math display">\[\begin{bmatrix}\beta_0\\\beta_1\end{bmatrix}=\begin{bmatrix}4&amp;22\\22&amp;142\end{bmatrix}^{-1}\begin{bmatrix}9\\57\end{bmatrix}\]</span></p>
<p><span class="math display">\[ = \frac{1}{84}\begin{bmatrix}142&amp;-22\\-22&amp;4\end{bmatrix}\begin{bmatrix}9\\57\end{bmatrix}\]</span></p>
<p><span class="math display">\[ = \begin{bmatrix}2/7\\5/14\end{bmatrix}\]</span></p>
</div>
<div class="fragment">
<p>So the least-squares line has the equation</p>
<p><span class="math display">\[y = \frac{2}{7} + \frac{5}{14}x.\]</span></p>
</div>
<div class="fragment">
<div class="ctrd">
<div id="5b361b09" class="cell" data-execution_count="7">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="L23LinearModels_files/figure-html/cell-8-output-1.png" width="505" height="490" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="the-general-linear-model" class="level2">
<h2 class="anchored" data-anchor-id="the-general-linear-model">The General Linear Model</h2>
<div class="fragment">
<p>Another way that the inconsistent linear system is often written is to collect all the residuals into a <strong>residual vector.</strong></p>
<p>Then an exact equation is</p>
<p><span class="math display">\[\mathbf{y} = X\mathbf{\beta} + {\mathbf\epsilon}\]</span></p>
</div>
<div class="fragment">
<p>Any equation of this form is referred to as a <strong>linear model.</strong></p>
<p>In this formulation, the goal is to minimize the length of <span class="math inline">\(\epsilon\)</span>, ie, <span class="math inline">\(\Vert\epsilon\Vert.\)</span></p>
</div>
<div class="fragment">
<p>In some cases, one would like to fit data points with something other than a straight line.</p>
<p>For example, think of Gauss trying to find the equation for the orbit of Ceres.</p>
<p>In cases like this, the matrix equation is still <span class="math inline">\(X\mathbf{\beta} = \mathbf{y}\)</span>, but the specific form of <span class="math inline">\(X\)</span> changes from one problem to the next.</p>
</div>
<div class="fragment">
<p>The least-squares solution <span class="math inline">\(\hat{\mathbf{\beta}}\)</span> is a solution of the normal equations</p>
<p><span class="math display">\[X^TX\mathbf{\beta} = X^T\mathbf{y}.\]</span></p>
</div>
</section>
<section id="least-squares-fitting-of-other-models" class="level2">
<h2 class="anchored" data-anchor-id="least-squares-fitting-of-other-models">Least-Squares Fitting of Other Models</h2>
<div class="fragment">
<p>Most models have parameters, and the object of <strong>model fitting</strong> is to to fix those parameters. Let’s talk about model parameters.</p>
</div>
<div class="fragment">
<p>In model fitting, the parameters are the unknown. A central question for us is whether the model is <em>linear</em> in its parameters.</p>
</div>
<div class="fragment">
<p>For example, the model <span class="math inline">\(y = \beta_0 e^{-\beta_1 x}\)</span> is <strong>not</strong> linear in its parameters.</p>
<p>The model <span class="math inline">\(y = \beta_0 e^{-2 x}\)</span> <strong>is</strong> linear in its parameters.</p>
</div>
<div class="fragment">
<p>For a model that is linear in its parameters, an observation is a linear combination of (arbitrary) known functions.</p>
</div>
<div class="fragment">
<p>In other words, a model that is linear in its parameters is</p>
<p><span class="math display">\[y = \beta_0f_0(x) + \beta_1f_1(x) + \dots + \beta_nf_n(x)\]</span></p>
<p>where <span class="math inline">\(f_0, \dots, f_n\)</span> are known functions and <span class="math inline">\(\beta_0,\dots,\beta_k\)</span> are parameters.</p>
</div>
<p><strong>Example.</strong> Suppose data points <span class="math inline">\((x_1, y_1), \dots, (x_n, y_n)\)</span> appear to lie along some sort of parabola instead of a straight line. Suppose we wish to approximate the data by an equation of the form</p>
<p><span class="math display">\[y = \beta_0 + \beta_1x + \beta_2x^2.\]</span></p>
<p>Describe the linear model that produces a “least squares fit” of the data by the equation.</p>
<div class="fragment">
<p><strong>Solution.</strong> The ideal relationship is <span class="math inline">\(y = \beta_0 + \beta_1x + \beta_2x^2.\)</span></p>
</div>
<div class="fragment">
<p>Suppose the actual values of the parameters are <span class="math inline">\(\beta_0, \beta_1, \beta_2.\)</span> Then the coordinates of the first data point satisfy the equation</p>
<p><span class="math display">\[y_1 = \beta_0 + \beta_1x_1 + \beta_2x_1^2 + \epsilon_1\]</span></p>
<p>where <span class="math inline">\(\epsilon_1\)</span> is the residual error between the observed value <span class="math inline">\(y_1\)</span> and the predicted <span class="math inline">\(y\)</span>-value.</p>
</div>
<div class="fragment">
<p>Each data point determines a similar equation:</p>
<p><span class="math display">\[y_1 = \beta_0 + \beta_1x_1 + \beta_2x_1^2 + \epsilon_1\]</span> <span class="math display">\[y_2 = \beta_0 + \beta_1x_2 + \beta_2x_2^2 + \epsilon_2\]</span> <span class="math display">\[\vdots\]</span> <span class="math display">\[y_n = \beta_0 + \beta_1x_n + \beta_2x_n^2 + \epsilon_n\]</span></p>
</div>
<div class="fragment">
<p>Clearly, this system can be written as <span class="math inline">\(\mathbf{y} = X\mathbf{\beta} + \mathbf{\epsilon}.\)</span></p>
<p><span class="math display">\[\begin{bmatrix}y_1\\y_2\\\vdots\\y_n\end{bmatrix} = \begin{bmatrix}1&amp;x_1&amp;x_1^2\\1&amp;x_2&amp;x_2^2\\\vdots&amp;\vdots&amp;\vdots\\1&amp;x_n&amp;x_n^2\end{bmatrix} \begin{bmatrix}\beta_0\\\beta_1\\\beta_2\end{bmatrix} + \begin{bmatrix}\epsilon_1\\\epsilon_2\\\vdots\\\epsilon_n\end{bmatrix}\]</span></p>
</div>
<div class="fragment">
<div class="ctrd">
<div id="d2e0e492" class="cell" data-execution_count="8">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="L23LinearModels_files/figure-html/cell-9-output-1.png" width="501" height="476" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<div class="ctrd">
<div id="be92ddac" class="cell" data-execution_count="9">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="L23LinearModels_files/figure-html/cell-10-output-1.png" width="501" height="476" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="multiple-regression" class="level2">
<h2 class="anchored" data-anchor-id="multiple-regression">Multiple Regression</h2>
<div class="fragment">
<p>Suppose an experiment involves two independent variables – say, <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span>, – and one dependent variable, <span class="math inline">\(y\)</span>.</p>
<p>A linear equation for predicting <span class="math inline">\(y\)</span> from <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> has the form</p>
<p><span class="math display">\[y = \beta_0 + \beta_1 u + \beta_2 v\]</span></p>
</div>
<div class="fragment">
<p>Since there is more than one independent variable, this is called <strong>multiple regression.</strong></p>
</div>
<div class="fragment">
<p>A more general prediction equation might have the form</p>
<p><span class="math display">\[y = \beta_0 + \beta_1 u + \beta_2 v + \beta_3u^2 + \beta_4 uv + \beta_5 v^2\]</span></p>
<p>A least squares fit to equations like this is called a <strong>trend surface.</strong></p>
</div>
<div class="fragment">
<p>In general, a linear model will arise whenever <span class="math inline">\(y\)</span> is to be predicted by an equation of the form</p>
<p><span class="math display">\[y = \beta_0f_0(u,v) + \beta_1f_1(u,v) + \cdots + \beta_kf_k(u,v)\]</span></p>
<p>with <span class="math inline">\(f_0,\dots,f_k\)</span> any sort of known functions and <span class="math inline">\(\beta_0,...,\beta_k\)</span> unknown weights.</p>
</div>
<div class="fragment">
<p><strong>Example.</strong> In geography, local models of terrain are constructed from data <span class="math inline">\((u_1, v_1, y_1), \dots, (u_n, v_n, y_n)\)</span> where <span class="math inline">\(u_j, v_j\)</span>, and <span class="math inline">\(y_j\)</span> are latitude, longitude, and altitude, respectively.</p>
</div>
<div class="fragment">
<p>Let’s take an example. Here are a set of points in <span class="math inline">\(\mathbb{R}^3\)</span>:</p>
<div class="ctrd">
<div id="0f9b50df" class="cell" data-execution_count="10">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="L23LinearModels_files/figure-html/cell-11-output-1.png" width="496" height="520" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>Let’s describe the linear models that gives a least-squares fit to such data. The solution is called the least-squares <em>plane.</em></p>
</div>
<div class="fragment">
<p><strong>Solution.</strong> We expect the data to satisfy these equations:</p>
<p><span class="math display">\[y_1 = \beta_0 + \beta_1 u_1 + \beta_2 v_1 + \epsilon_1\]</span> <span class="math display">\[y_1 = \beta_0 + \beta_1 u_2 + \beta_2 v_2 + \epsilon_2\]</span> <span class="math display">\[\vdots\]</span> <span class="math display">\[y_1 = \beta_0 + \beta_1 u_n + \beta_2 v_n + \epsilon_n\]</span></p>
</div>
<div class="fragment">
<p>This system has the matrix for <span class="math inline">\(\mathbf{y} = X\mathbf{\beta} + \epsilon,\)</span> where</p>
<p><span class="math display">\[\mathbf{y} = \begin{bmatrix}y_1\\y_1\\\vdots\\y_n\end{bmatrix},\;\;X = \begin{bmatrix}1&amp;u_1&amp;v_1\\1&amp;u_2&amp;v_2\\\vdots&amp;\vdots&amp;\vdots\\1&amp;u_n&amp;v_n\end{bmatrix},\;\;\mathbf{\beta}=\begin{bmatrix}\beta_0\\\beta_1\\\beta_2\end{bmatrix},\;\;\epsilon = \begin{bmatrix}\epsilon_1\\\epsilon_2\\\vdots\\\epsilon_n\end{bmatrix}\]</span></p>
<div class="ctrd">
<div id="790f58ce" class="cell" data-execution_count="11">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="L23LinearModels_files/figure-html/cell-12-output-1.png" width="470" height="520" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>This example shows that the linear model for multiple regression has the same abstract form as the model for the simple regression in the earlier examples.</p>
</div>
<div class="fragment">
<p>We can see that there the general principle is the same across all the different kinds of linear models.</p>
</div>
<div class="fragment">
<p>Once <span class="math inline">\(X\)</span> is defined properly, the normal equations for <span class="math inline">\(\mathbf{\beta}\)</span> have the same matrix form, no matter how many variables are involved.</p>
<p>Thus, for any linear model where <span class="math inline">\(X^TX\)</span> is invertible, the least squares <span class="math inline">\(\hat{\mathbf{\beta}}\)</span> is given by <span class="math inline">\((X^TX)^{-1}X^T\mathbf{y}\)</span>.</p>
</div>
</section>
<section id="multiple-regression-in-practice" class="level2">
<h2 class="anchored" data-anchor-id="multiple-regression-in-practice">Multiple Regression in Practice</h2>
<div class="fragment">
<p>Let’s see how powerful multiple regression can be on a real-world example.</p>
<p>A typical application of linear models is predicting house prices. Linear models have been used for this problem for decades, and when a municipality does a value assessment on your house, they typically use a linear model.</p>
</div>
<div class="fragment">
<p>We can consider various measurable attributes of a house (its “features”) as the independent variables, and the most recent sale price of the house as the dependent variable.</p>
</div>
<div class="fragment">
<p>For our case study, we will use the features:</p>
<ul>
<li>Lot Area (sq ft),</li>
<li>Gross Living Area (sq ft),</li>
<li>Number of Fireplaces,</li>
<li>Number of Full Baths,</li>
<li>Number of Half Baths,</li>
<li>Garage Area (sq ft),</li>
<li>Basement Area (sq ft)</li>
</ul>
</div>
<div class="fragment">
<p>So our design matrix will have 8 columns (including the constant for the intercept):</p>
<p><span class="math display">\[ X\beta = \mathbf{y}\]</span></p>
<p>and it will have one row for each house in the data set, with <span class="math inline">\(y\)</span> the sale price of the house.</p>
</div>
<div class="fragment">
<p>We will use data from housing sales in Ames, Iowa from 2006 to 2009:</p>
</div>
<div class="fragment">
<div id="f5c30249" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'data/ames-housing-data/train.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div id="2b5e0421" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">'LotArea'</span>, <span class="st">'GrLivArea'</span>, <span class="st">'Fireplaces'</span>, <span class="st">'FullBath'</span>, <span class="st">'HalfBath'</span>, <span class="st">'GarageArea'</span>, <span class="st">'TotalBsmtSF'</span>, <span class="st">'SalePrice'</span>]].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">LotArea</th>
<th data-quarto-table-cell-role="th">GrLivArea</th>
<th data-quarto-table-cell-role="th">Fireplaces</th>
<th data-quarto-table-cell-role="th">FullBath</th>
<th data-quarto-table-cell-role="th">HalfBath</th>
<th data-quarto-table-cell-role="th">GarageArea</th>
<th data-quarto-table-cell-role="th">TotalBsmtSF</th>
<th data-quarto-table-cell-role="th">SalePrice</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>8450</td>
<td>1710</td>
<td>0</td>
<td>2</td>
<td>1</td>
<td>548</td>
<td>856</td>
<td>208500</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>9600</td>
<td>1262</td>
<td>1</td>
<td>2</td>
<td>0</td>
<td>460</td>
<td>1262</td>
<td>181500</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>11250</td>
<td>1786</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>608</td>
<td>920</td>
<td>223500</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>9550</td>
<td>1717</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>642</td>
<td>756</td>
<td>140000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>14260</td>
<td>2198</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>836</td>
<td>1145</td>
<td>250000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
<div class="fragment">
<div id="5d206476" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>X_no_intercept <span class="op">=</span> df[[<span class="st">'LotArea'</span>, <span class="st">'GrLivArea'</span>, <span class="st">'Fireplaces'</span>, <span class="st">'FullBath'</span>, <span class="st">'HalfBath'</span>, <span class="st">'GarageArea'</span>, <span class="st">'TotalBsmtSF'</span>]].values</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'SalePrice'</span>].values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p>Next we add a column of 1s to the design matrix, which adds a constant intercept to the model:</p>
</div>
<div class="fragment">
<div id="7d4db590" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.column_stack([np.ones(X_no_intercept.shape[<span class="dv">0</span>], dtype <span class="op">=</span> <span class="st">'int'</span>), X_no_intercept])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div id="0c333c4e" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>array([[    1,  8450,  1710, ...,     1,   548,   856],
       [    1,  9600,  1262, ...,     0,   460,  1262],
       [    1, 11250,  1786, ...,     1,   608,   920],
       ...,
       [    1,  9042,  2340, ...,     0,   252,  1152],
       [    1,  9717,  1078, ...,     0,   240,  1078],
       [    1,  9937,  1256, ...,     1,   276,  1256]])</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>Now let’s peform the least-squares regression:</p>
<p><span class="math display">\[\hat{\beta} = (X^TX)^{-1}X^T \mathbf{y}\]</span></p>
</div>
<div class="fragment">
<div id="d2db963b" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>beta_hat <span class="op">=</span> np.linalg.inv(X.T <span class="op">@</span> X) <span class="op">@</span> X.T <span class="op">@</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p>What does our model tell us?</p>
</div>
<div class="fragment">
<div id="d2a3bbe8" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>beta_hat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>array([-2.92338280e+04,  1.87444579e-01,  3.94185205e+01,  1.45698657e+04,
        2.29695596e+04,  1.62834807e+04,  9.14770980e+01,  5.11282216e+01])</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>We see that we have:</p>
<ul>
<li><span class="math inline">\(\beta_0\)</span>: Intercept of -$29,233</li>
<li><span class="math inline">\(\beta_1\)</span>: Marginal value of one square foot of Lot Area: $18</li>
<li><span class="math inline">\(\beta_2\)</span>: Marginal value of one square foot of Gross Living Area: $39</li>
<li><span class="math inline">\(\beta_3\)</span>: Marginal value of one additional fireplace: $14,570</li>
<li><span class="math inline">\(\beta_4\)</span>: Marginal value of one additional full bath: $22,970</li>
<li><span class="math inline">\(\beta_5\)</span>: Marginal value of one additional half bath: $16,283</li>
<li><span class="math inline">\(\beta_6\)</span>: Marginal value of one square foot of Garage Area: $91</li>
<li><span class="math inline">\(\beta_7\)</span>: Marginal value of one square foot of Basement Area: $51</li>
</ul>
</div>
<div class="fragment">
<p>Is our model doing a good job?</p>
<p>There are many statistics for testing this question, but we’ll just look at the predictions versus the ground truth.</p>
<p>For each house we compute its predicted sale value according to our model:</p>
<p><span class="math display">\[\hat{\mathbf{y}} = X\hat{\beta}\]</span></p>
</div>
<div class="fragment">
<div id="37e90990" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>y_hat <span class="op">=</span> X <span class="op">@</span> beta_hat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<p>And for each house, we’ll plot its predicted versus actual sale value:</p>
<div class="ctrd">
<div id="514837b7" class="cell" data-execution_count="20">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="L23LinearModels_files/figure-html/cell-21-output-1.png" width="619" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>We see that the model does a reasonable job for house values less than about $250,000.</p>
<p>For a better model, we’d want to consider more features of each house, and perhaps some additional functions such as polynomials as components of our model.</p>
</div>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>